# Copyright (c) 2024 Rapid Silicon
# SPDX-License-Identifier: Apache-2.0

description: |
  The Rapid Silicon pin controller has one register per pin number. 
  Each register exposes the four modes:

     PIN_FN_MAIN
     PIN_FN_FPGA
     PIN_FN_ALT
     PIN_FN_DEBUG

  It also exposes the bits to enable or disable the pull resistors 
  as well as direction to pull a pin. 
  
  As a result, the following shows an example of a pin 
  configuration for one flow engine peripheral in virgo_tc_eval board.

  #include <dt-bindings/pinctrl/rapidsi_virgo_pinctrl.h>

  /*
    In the following example, each element in pins property is defined as:
    1 - phandle to pinctrl node
    2 - pin number
    3 - pin mode as listed above.
    4 - pin pull resistor enabled or disabled
    5 - pin pull resistor direction being up or down.
  */
  &pinctrl {
    #pin-cells = <4>;
    ofe_default_pinmux {   
      group1 { 
        pins = <&pinctrl 0 PIN_FN_ALT PIN_PULL_STATUS_DIS PIN_PULL_DIR_DOWN>;
        pin-names = "CONFIG_DONE";
      };
      group2 {
        pins = <&pinctrl 1 PIN_FN_ALT PIN_PULL_STATUS_DIS PIN_PULL_DIR_DOWN>;
        pin-names = "CONFIG_ERROR";
      };
    };
  };

  &ofe {
    pinctrl-0 = <&ofe_default_pinmux>;
  };

  In the above example, config_done is assigned pin number 0 with 
  alternate functionality where pull resistors are disabled. In case the
  pull resistors are disabled the PIN_PULL_DIR... argument is ignored.

compatible: "rapidsi,pinctrl"

include: [base.yaml]

child-binding:
  description: |
    rapidsi pin controller pin configuration state nodes.
    
  child-binding:
    description: |
      rapidsi pin controller pin configuration group.

    properties:

      pinmaps:
        type: phandle-array
        description: |
          This property describes the details about the pad to be configured
          for the purpose of driving a corresponding Pad in a specific
          mode.

      pinmap-names:
        type: string-array
        description: |
            This is an array of strings defining the names of the PAD lines
            going out of the PAD controller
          
properties:

  npins:
    type: int
    required: true

  "#pinmap-cells":
    type: int
    const: 4

pinmap-cells:
  - pin_num
  - pin_mode
  - pin_pull_state
  - pin_pull_dir